<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>mmrd</title>
  <link rel="stylesheet" type="text/css" href="css/markd.css" />
  <link rel="stylesheet" type="text/css" media="print" href="css/markd-print.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/markd-screen.css" />
  <link rel="stylesheet" type="text/css" href="css/prettify.css" />
</head>

<body>
  
<h1>mmrd</h1>

<p>mmrd, MongoDB MapReduce Driver, is driver utility for testing Map and Reduce function of MongoDB.</p>

<p>You can invoke your Map and Reduce functions whether isolated or integrated with without MongoDB itself.</p>

<h3>Notice</h3>

<p>mmrd is Node.js module. It would behave different from MongoDB in paticular situation because Javascript engine that MongoDB uses is SpiderMonkey rather than V8.</p>

<h2>Installation</h2>

<pre><code>$ npm install mmrd
</code></pre>

<h2>Word Count Example</h2>

<p>Now show you word-count example below.</p>

<p>First, there are 'map.js' and 'reduce.js' for MongoDB's MapReduce.
"map" or "reduce" function must be implemented in these codes.</p>

<p>map.js</p>

<pre><code>function map() {
  var words = this.text.split(' ');
  words.forEach(function(word) {
    emit(word, 1);
  });
}
</code></pre>

<p>reduce.js</p>

<pre><code>function reduce(key, values) {
  var result = 0;
  values.forEach(function(v) {
    result += v;
  });
  return result;
}
</code></pre>

<p>Then, you can invoke MapReduce functionality using mmrd.</p>

<pre><code>var mmrd = require('mmrd');

// map test
(function() {
  console.log("Word count / Map test");
  var doc = { text: "foo bar baz" };
  mmrd.loadMap('map.js');
  mmrd.map(doc, function(key, value) {
    console.log(key, ":", value);
  });
})();

// reduce test
(function() {
  console.log("Word count / Reduce test");
  mmrd.loadReduce('reduce.js');
  var key = "foo";
  var values = [1, 1];
  var reduced = mmrd.reduce(key, values);
  console.log(key, ":", reduced);
})();

// integration test
(function() {
  console.log("Word count / Integration test");
  var docs = [
    { text: "foo bar baz" },
    { text: "foo baz baz"}
  ];
  mmrd.loadMap('map.js');
  mmrd.loadReduce('reduce.js');
  var result = mmrd.mapReduce(docs);
  console.log(result);
})();
</code></pre>

<h2>License</h2>

<p>mmrd is released under the MIT license.</p>

<h2>Copyright</h2>

<p>Copyright (c) 2012 <a href="http://opentechnica.blogspot.com/">daisuke sugimori</a> (Twitter: <a href="https://twitter.com/daixque">@daixque</a>).</p>

<script lang="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/prettify.js"></script>
<script lang="text/javascript" src="js/markd.js"></script>

</body>
</html>
